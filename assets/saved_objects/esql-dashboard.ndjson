{"attributes":{"color":"#9f5aa3","description":"","name":"chargeback"},"coreMigrationVersion":"8.8.0","created_at":"2025-05-31T05:09:24.267Z","created_by":"u_2001809318_cloud","id":"1238481e-f5f7-419d-a171-57760b64ece6","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-05-31T05:09:24.267Z","updated_by":"u_2001809318_cloud","version":"WzI1NTgsMV0="}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"title\":\"Storage\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n//    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n//    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n//    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n//    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu\\n//    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    store_portion\\n| STATS \\n    total_store_portion = sum(store_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_store_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_store_portion\\n| SORT total_store_portion DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"d25acb24-49ec-445b-bc17-5f400539ae7d\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n//    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n//    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n//    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n//    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu\\n//    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    store_portion\\n| STATS \\n    total_store_portion = sum(store_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_store_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_store_portion\\n| SORT total_store_portion DESC\"},\"columns\":[{\"columnId\":\"elasticsearch.index.datastream\",\"fieldName\":\"elasticsearch.index.datastream\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_store_portion\",\"fieldName\":\"total_store_portion\",\"label\":\"Storage\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"percent\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n//    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n//    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n//    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n//    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu\\n//    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    store_portion\\n| STATS \\n    total_store_portion = sum(store_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_store_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_store_portion\\n| SORT total_store_portion DESC\"},\"visualization\":{\"shape\":\"pie\",\"layers\":[{\"layerId\":\"d25acb24-49ec-445b-bc17-5f400539ae7d\",\"primaryGroups\":[\"elasticsearch.index.datastream\"],\"metrics\":[\"total_store_portion\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"be08de5f-f5b8-473c-a27d-e85078210858\",\"gridData\":{\"i\":\"be08de5f-f5b8-473c-a27d-e85078210858\",\"y\":41,\"x\":24,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"Blended\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_ece_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_ece_portion\\n| SORT total_ece_portion DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"aef85e9a-6d9e-4804-99a0-fced3debe690\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_ece_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_ece_portion\\n| SORT total_ece_portion DESC\"},\"columns\":[{\"columnId\":\"elasticsearch.index.datastream\",\"fieldName\":\"elasticsearch.index.datastream\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_ece_portion\",\"fieldName\":\"total_ece_portion\",\"label\":\"Blended\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"percent\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_ece_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_ece_portion\\n| SORT total_ece_portion DESC\"},\"visualization\":{\"shape\":\"pie\",\"layers\":[{\"layerId\":\"aef85e9a-6d9e-4804-99a0-fced3debe690\",\"primaryGroups\":[\"elasticsearch.index.datastream\"],\"metrics\":[\"total_ece_portion\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"e97ac831-c320-4536-80c2-636b72ec2426\",\"gridData\":{\"i\":\"e97ac831-c320-4536-80c2-636b72ec2426\",\"y\":41,\"x\":36,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"Table @timestamp & composite_key & composite_tier_key & elasticsearch.cluster.name & elasticsearch.index.datastream\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"hidePanelTitles\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (elasticsearch.index.tier == \\\"hot/content\\\", (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n//| KEEP\\n//    @timestamp, \\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n//    elasticsearch.index.tier, \\n//    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    total_ece_portion\"},\"attributes\":{\"title\":\"Pie\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"7d49a98d-87d1-4980-981e-fd92d4ef1456\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (elasticsearch.index.tier == \\\"hot/content\\\", (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n//| KEEP\\n//    @timestamp, \\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n//    elasticsearch.index.tier, \\n//    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    total_ece_portion\"},\"columns\":[{\"columnId\":\"total_ece_portion\",\"fieldName\":\"total_ece_portion\",\"label\":\"Total ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"elasticsearch.cluster.name\",\"fieldName\":\"elasticsearch.cluster.name\",\"label\":\"Deployment ID\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}}},{\"columnId\":\"579f97da-3c23-43f9-bf71-b9ccb3e6a4c0\",\"fieldName\":\"elasticsearch.index.tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"elasticsearch.index.tier\"}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (elasticsearch.index.tier == \\\"hot/content\\\", (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n//| KEEP\\n//    @timestamp, \\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n//    elasticsearch.index.tier, \\n//    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    total_ece_portion\"},\"visualization\":{\"shape\":\"treemap\",\"layers\":[{\"layerId\":\"7d49a98d-87d1-4980-981e-fd92d4ef1456\",\"primaryGroups\":[\"elasticsearch.cluster.name\",\"579f97da-3c23-43f9-bf71-b9ccb3e6a4c0\"],\"metrics\":[\"total_ece_portion\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"c359d961-4008-4e34-ae46-9198f0aa919a\",\"gridData\":{\"i\":\"c359d961-4008-4e34-ae46-9198f0aa919a\",\"y\":11,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"Table @timestamp & composite_key & composite_tier_key & elasticsearch.cluster.name & elasticsearch.index.datastream\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"hidePanelTitles\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ecu_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n    elasticsearch.index.datastream, \\n    elasticsearch.index.tier,\\n    indexing_portion,\\n    query_portion,    \\n    store_portion,\\n    ecu_portion\\n| STATS \\n    total_indexing_portion = sum(indexing_portion),\\n    total_query_portion = sum(query_portion),\\n    total_store_portion = sum(store_portion),\\n    total_ecu_portion = sum(ecu_portion)\\n  BY \\n    elasticsearch.index.datastream,\\n    elasticsearch.index.tier\\n| WHERE total_ecu_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    elasticsearch.index.tier,\\n    total_indexing_portion,\\n    total_query_portion,\\n    total_store_portion,\\n    total_ecu_portion\\n| SORT total_ecu_portion DESC\"},\"attributes\":{\"title\":\"total_indexing_portion & total_query_portion & total_store_portion of elasticsearch.index.tier\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"744aa3c7-5680-4235-80b9-ae099bc5d2fb\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ecu_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n    elasticsearch.index.datastream, \\n    elasticsearch.index.tier,\\n    indexing_portion,\\n    query_portion,    \\n    store_portion,\\n    ecu_portion\\n| STATS \\n    total_indexing_portion = sum(indexing_portion),\\n    total_query_portion = sum(query_portion),\\n    total_store_portion = sum(store_portion),\\n    total_ecu_portion = sum(ecu_portion)\\n  BY \\n    elasticsearch.index.datastream,\\n    elasticsearch.index.tier\\n| WHERE total_ecu_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    elasticsearch.index.tier,\\n    total_indexing_portion,\\n    total_query_portion,\\n    total_store_portion,\\n    total_ecu_portion\\n| SORT total_ecu_portion DESC\"},\"columns\":[{\"columnId\":\"03e74fcb-b01c-4ccf-b4e8-68fdce998071\",\"fieldName\":\"elasticsearch.index.datastream\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Data stream\",\"customLabel\":true},{\"columnId\":\"c88e8842-12fd-4f55-ad58-9578b9f1b2d2\",\"fieldName\":\"elasticsearch.index.tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Data tier\",\"customLabel\":true},{\"columnId\":\"5dc4df14-ddf5-434f-b8c6-dfd7092e4023\",\"fieldName\":\"total_indexing_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Indexing\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"3e984e7c-6e4a-4adb-9faa-0823285a0448\",\"fieldName\":\"total_query_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Querying\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"5be7515a-f469-4371-9428-c20fa8236560\",\"fieldName\":\"total_store_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Storage\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"34dce5ea-146a-4c39-b634-c58c989411da\",\"fieldName\":\"total_ecu_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Blended\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ecu_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n    elasticsearch.index.datastream, \\n    elasticsearch.index.tier,\\n    indexing_portion,\\n    query_portion,    \\n    store_portion,\\n    ecu_portion\\n| STATS \\n    total_indexing_portion = sum(indexing_portion),\\n    total_query_portion = sum(query_portion),\\n    total_store_portion = sum(store_portion),\\n    total_ecu_portion = sum(ecu_portion)\\n  BY \\n    elasticsearch.index.datastream,\\n    elasticsearch.index.tier\\n| WHERE total_ecu_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    elasticsearch.index.tier,\\n    total_indexing_portion,\\n    total_query_portion,\\n    total_store_portion,\\n    total_ecu_portion\\n| SORT total_ecu_portion DESC\"},\"visualization\":{\"layerId\":\"744aa3c7-5680-4235-80b9-ae099bc5d2fb\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"03e74fcb-b01c-4ccf-b4e8-68fdce998071\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"c88e8842-12fd-4f55-ad58-9578b9f1b2d2\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"5dc4df14-ddf5-434f-b8c6-dfd7092e4023\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"3e984e7c-6e4a-4adb-9faa-0823285a0448\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"5be7515a-f469-4371-9428-c20fa8236560\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"34dce5ea-146a-4c39-b634-c58c989411da\",\"isTransposed\":false,\"isMetric\":true}],\"sorting\":{\"columnId\":\"34dce5ea-146a-4c39-b634-c58c989411da\",\"direction\":\"desc\"}},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\"}},\"panelIndex\":\"84687a98-3e8c-4408-ab82-8c1a0c6489c1\",\"gridData\":{\"i\":\"84687a98-3e8c-4408-ab82-8c1a0c6489c1\",\"y\":56,\"x\":0,\"w\":48,\"h\":15}},{\"type\":\"lens\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"hidePanelTitles\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (elasticsearch.index.tier == \\\"hot/content\\\", (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n//| KEEP\\n//    @timestamp, \\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n//    elasticsearch.index.tier, \\n//    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    total_ece_portion\"},\"attributes\":{\"title\":\"Pie\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"4e247484-7026-4cc4-8aac-7adbbf7ce886\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (elasticsearch.index.tier == \\\"hot/content\\\", (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n//| KEEP\\n//    @timestamp, \\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n//    elasticsearch.index.tier, \\n//    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    total_ece_portion\"},\"columns\":[{\"columnId\":\"deployment_name\",\"fieldName\":\"deployment_name\",\"label\":\"Deployment Name\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"text\"}},{\"columnId\":\"elasticsearch.cluster.name\",\"fieldName\":\"elasticsearch.cluster.name\",\"label\":\"Deployment ID\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"2d74c51f-7631-42d9-adea-77ee3b6a85b1\",\"fieldName\":\"elasticsearch.index.tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"label\":\"Tier\",\"customLabel\":true},{\"columnId\":\"total_ece_portion\",\"fieldName\":\"total_ece_portion\",\"label\":\"Total ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\",\"allColumns\":[{\"columnId\":\"deployment_name\",\"fieldName\":\"deployment_name\",\"label\":\"deployment_name\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"text\"}},{\"columnId\":\"2d74c51f-7631-42d9-adea-77ee3b6a85b1\",\"fieldName\":\"elasticsearch.index.tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"elasticsearch.cluster.name\",\"fieldName\":\"elasticsearch.cluster.name\",\"label\":\"elasticsearch.cluster.name\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_ece_portion\",\"fieldName\":\"total_ece_portion\",\"label\":\"Total ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"elasticsearch.index.tier\",\"fieldName\":\"elasticsearch.index.tier\",\"label\":\"elasticsearch.index.tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}]}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (elasticsearch.index.tier == \\\"hot/content\\\", (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n//| KEEP\\n//    @timestamp, \\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n//    elasticsearch.index.tier, \\n//    ece_portion\\n| STATS \\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    total_ece_portion\"},\"visualization\":{\"layerId\":\"4e247484-7026-4cc4-8aac-7adbbf7ce886\",\"layerType\":\"data\",\"columns\":[{\"isTransposed\":false,\"columnId\":\"elasticsearch.cluster.name\",\"isMetric\":false},{\"columnId\":\"deployment_name\"},{\"columnId\":\"total_ece_portion\",\"summaryRow\":\"sum\"},{\"columnId\":\"2d74c51f-7631-42d9-adea-77ee3b6a85b1\",\"isTransposed\":false,\"isMetric\":false}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\"}},\"panelIndex\":\"1dba5f65-7ee3-41fc-8611-762b1f9cf7f1\",\"gridData\":{\"i\":\"1dba5f65-7ee3-41fc-8611-762b1f9cf7f1\",\"y\":11,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"ECU spend over the last 6 months\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| WHERE @timestamp < now()\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold),\\n    date = DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp)\\n| KEEP\\n    date,\\n    @timestamp, \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    ece_portion\"},\"timeRange\":{\"from\":\"now-6M\",\"to\":\"now\"},\"attributes\":{\"title\":\"Table date & @timestamp & elasticsearch.cluster.name & deployment_name & elasticsearch.index.tier\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"10e69e82-4e3d-4875-928d-02045eebbda7\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| WHERE @timestamp < now()\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold),\\n    date = DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp)\\n| KEEP\\n    date,\\n    @timestamp, \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    ece_portion\"},\"columns\":[],\"timeField\":\"@timestamp\"},\"0996827b-b17e-4dc1-8e40-d3617eb77e41\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| WHERE @timestamp < now()\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold),\\n    date = DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp)\\n| KEEP\\n    date,\\n    @timestamp, \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    ece_portion\"},\"columns\":[{\"columnId\":\"19682235-5120-4fb4-902f-08853b2b178a\",\"fieldName\":\"@timestamp\",\"meta\":{\"type\":\"date\",\"esType\":\"date\",\"sourceParams\":{\"appliedTimeRange\":{\"type\":\"timerange\",\"from\":\"now-2M\",\"to\":\"now\"},\"params\":{},\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Date\",\"customLabel\":true},{\"columnId\":\"96ee9680-58df-46ec-89c2-df804cbd8e91\",\"fieldName\":\"ece_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"ECU\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"4847a5c1-b737-4579-b304-dd59e684899f\",\"fieldName\":\"elasticsearch.cluster.name\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Deployment ID\",\"customLabel\":true}]}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| WHERE @timestamp < now()\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold),\\n    date = DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp)\\n| KEEP\\n    date,\\n    @timestamp, \\n    elasticsearch.cluster.name, \\n    deployment_name, \\n    elasticsearch.index.tier, \\n    ece_portion\"},\"visualization\":{\"title\":\"Empty XY chart\",\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"0996827b-b17e-4dc1-8e40-d3617eb77e41\",\"accessors\":[\"96ee9680-58df-46ec-89c2-df804cbd8e91\"],\"position\":\"top\",\"seriesType\":\"bar_stacked\",\"showGridlines\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}},\"xAccessor\":\"19682235-5120-4fb4-902f-08853b2b178a\",\"splitAccessor\":\"4847a5c1-b737-4579-b304-dd59e684899f\"}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"12f49116-e985-4996-823b-dd32865ae0fb\",\"gridData\":{\"i\":\"12f49116-e985-4996-823b-dd32865ae0fb\",\"y\":0,\"x\":0,\"w\":48,\"h\":8}},{\"type\":\"visualization\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"id\":\"\",\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# ECU deployment statistics\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"63625fd3-27d8-468f-bee9-a5d846460aa3\",\"gridData\":{\"i\":\"63625fd3-27d8-468f-bee9-a5d846460aa3\",\"y\":8,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# ECU data tier and data stream overview\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"a615f9c5-70b2-4cc2-9b3e-a6e6d49cd493\",\"gridData\":{\"i\":\"a615f9c5-70b2-4cc2-9b3e-a6e6d49cd493\",\"y\":26,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# Indexing\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"cabad7dd-82b8-4e50-a139-822cb3c4bd27\",\"gridData\":{\"i\":\"cabad7dd-82b8-4e50-a139-822cb3c4bd27\",\"y\":38,\"x\":0,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# Querying\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"b4049337-42a9-4fdb-9369-6ccf27e64905\",\"gridData\":{\"i\":\"b4049337-42a9-4fdb-9369-6ccf27e64905\",\"y\":38,\"x\":12,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# Storage\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"d2826832-b0af-4a22-b488-149e6b7dd02b\",\"gridData\":{\"i\":\"d2826832-b0af-4a22-b488-149e6b7dd02b\",\"y\":38,\"x\":24,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# Blended\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"1aed858d-aff5-49da-ae13-4c9c4fff8fc7\",\"gridData\":{\"i\":\"1aed858d-aff5-49da-ae13-4c9c4fff8fc7\",\"y\":38,\"x\":36,\"w\":12,\"h\":3}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| STATS \\n    total_query_portion = sum(query_portion),\\n    total_indexing_portion = sum(indexing_portion),\\n    total_store_portion = sum(store_portion),\\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.index.tier, \\n    total_query_portion,\\n    total_indexing_portion,\\n    total_store_portion,\\n    total_ece_portion\"},\"attributes\":{\"title\":\"total_query_portion & total_indexing_portion & total_store_portion & total_ece_portion of elasticsearch.index.tier\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"cec75595-79d2-4bac-9836-5da08c5d9551\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| STATS \\n    total_query_portion = sum(query_portion),\\n    total_indexing_portion = sum(indexing_portion),\\n    total_store_portion = sum(store_portion),\\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.index.tier, \\n    total_query_portion,\\n    total_indexing_portion,\\n    total_store_portion,\\n    total_ece_portion\"},\"columns\":[{\"columnId\":\"3c2754b3-1404-4f92-800d-67ecd36d21a1\",\"fieldName\":\"elasticsearch.index.tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"label\":\"Data tier\",\"customLabel\":true},{\"columnId\":\"285df377-a526-4b1a-973a-dbbbb4ed9b6e\",\"fieldName\":\"total_indexing_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Indexing\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"6dba7617-6836-4d2e-968f-752b8f82f89b\",\"fieldName\":\"total_query_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Querying\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"abe3e87b-b964-44c4-a4b8-a1235209a738\",\"fieldName\":\"total_store_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Storage\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"219462f7-c887-4592-a973-b71b356ffe75\",\"fieldName\":\"total_ece_portion\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"monitoring-indices\"}},\"label\":\"Blended\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\",\"allColumns\":[{\"columnId\":\"elasticsearch.index.tier\",\"fieldName\":\"elasticsearch.index.tier\",\"label\":\"elasticsearch.index.tier\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"total_query_portion\",\"fieldName\":\"total_query_portion\",\"label\":\"total_query_portion\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true},{\"columnId\":\"total_indexing_portion\",\"fieldName\":\"total_indexing_portion\",\"label\":\"total_indexing_portion\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true},{\"columnId\":\"total_store_portion\",\"fieldName\":\"total_store_portion\",\"label\":\"total_store_portion\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true},{\"columnId\":\"total_ece_portion\",\"fieldName\":\"total_ece_portion\",\"label\":\"total_ece_portion\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true}]}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    composite_key,\\n    composite_tier_key,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.tier\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu,\\n    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    ece_portion = CASE (\\n            elasticsearch.index.tier == \\\"hot/content\\\", \\n            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| STATS \\n    total_query_portion = sum(query_portion),\\n    total_indexing_portion = sum(indexing_portion),\\n    total_store_portion = sum(store_portion),\\n    total_ece_portion = sum(ece_portion)\\n  BY \\n    elasticsearch.index.tier\\n| KEEP\\n    elasticsearch.index.tier, \\n    total_query_portion,\\n    total_indexing_portion,\\n    total_store_portion,\\n    total_ece_portion\"},\"visualization\":{\"layerId\":\"cec75595-79d2-4bac-9836-5da08c5d9551\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"3c2754b3-1404-4f92-800d-67ecd36d21a1\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"285df377-a526-4b1a-973a-dbbbb4ed9b6e\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"6dba7617-6836-4d2e-968f-752b8f82f89b\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"abe3e87b-b964-44c4-a4b8-a1235209a738\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"219462f7-c887-4592-a973-b71b356ffe75\",\"isTransposed\":false,\"isMetric\":true}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\"}},\"panelIndex\":\"19fe2d09-1411-41b7-b0f5-8a4c1ca199d6\",\"gridData\":{\"i\":\"19fe2d09-1411-41b7-b0f5-8a4c1ca199d6\",\"y\":29,\"x\":0,\"w\":48,\"h\":9}},{\"type\":\"lens\",\"title\":\"Indexing\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n//    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    indexing_portion\\n| STATS \\n    total_indexing_portion = sum(indexing_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_indexing_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_indexing_portion\\n| SORT total_indexing_portion DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"21b911bb-f863-40ca-81b3-5c61594bf97b\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n//    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    indexing_portion\\n| STATS \\n    total_indexing_portion = sum(indexing_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_indexing_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_indexing_portion\\n| SORT total_indexing_portion DESC\"},\"columns\":[{\"columnId\":\"elasticsearch.index.datastream\",\"fieldName\":\"elasticsearch.index.datastream\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_indexing_portion\",\"fieldName\":\"total_indexing_portion\",\"label\":\"Indexing\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"percent\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu,\\n    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n//    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    indexing_portion\\n| STATS \\n    total_indexing_portion = sum(indexing_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_indexing_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_indexing_portion\\n| SORT total_indexing_portion DESC\"},\"visualization\":{\"shape\":\"pie\",\"layers\":[{\"layerId\":\"21b911bb-f863-40ca-81b3-5c61594bf97b\",\"primaryGroups\":[\"elasticsearch.index.datastream\"],\"metrics\":[\"total_indexing_portion\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"6237758a-c8a9-473c-a38d-6ebc6d1aa87b\",\"gridData\":{\"i\":\"6237758a-c8a9-473c-a38d-6ebc6d1aa87b\",\"y\":41,\"x\":0,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"Querying\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"f870719c-80d5-44d0-b7f7-c15d71a5e760\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu\\n//    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n//    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    query_portion\\n| STATS \\n    total_query_portion = sum(query_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_query_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_query_portion\\n| SORT total_query_portion DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"d0281a3d-d9b0-4846-9d04-d51456009536\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu\\n//    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n//    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    query_portion\\n| STATS \\n    total_query_portion = sum(query_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_query_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_query_portion\\n| SORT total_query_portion DESC\"},\"columns\":[{\"columnId\":\"elasticsearch.index.datastream\",\"fieldName\":\"elasticsearch.index.datastream\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_query_portion\",\"fieldName\":\"total_query_portion\",\"label\":\"Querying\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"percent\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp),\\n    composite_key = CONCAT(DATE_FORMAT(\\\"yyyy-MM-dd\\\", @timestamp), \\\"_\\\", elasticsearch.cluster.name),\\n    composite_tier_key = CONCAT(composite_key, \\\"_\\\", REPLACE(elasticsearch.index.tier, \\\"/\\\", \\\"_\\\"))\\n| STATS \\n    sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis),\\n    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    composite_key,\\n    composite_tier_key,\\n//    elasticsearch.cluster.name,\\n    elasticsearch.index.tier,\\n    elasticsearch.index.datastream\\n| LOOKUP JOIN billing_cluster_cost_lookup ON composite_key\\n| WHERE total_ecu > 0\\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_key \\n| LOOKUP JOIN cluster_deployment_contribution_lookup on composite_tier_key\\n| WHERE elasticsearch.index.tier != tier\\n| EVAL \\n    query_portion = sum_query_time_local / (sum_query_time_local + sum_query_time) * total_ecu\\n//    indexing_portion = sum_indexing_time_local / (sum_indexing_time_local + sum_indexing_time) * total_ecu\\n//    store_portion = sum_store_size_local / (sum_store_size_local + sum_store_size) * total_ecu,\\n//    data_store_portion = sum_data_set_store_size_local / (sum_data_set_store_size_local + sum_data_set_store_size) * total_ecu,\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    ece_portion = CASE (\\n//            elasticsearch.index.tier == \\\"hot/content\\\", \\n//            (query_portion * query_weight + indexing_portion * index_weight + store_portion * storage_weight) / total_weight_hot, \\n//            (query_portion * query_weight + store_portion * storage_weight) / total_weight_cold)\\n| KEEP\\n//    elasticsearch.cluster.name, \\n//    deployment_name, \\n    elasticsearch.index.datastream, \\n    query_portion\\n| STATS \\n    total_query_portion = sum(query_portion)\\n  BY \\n    elasticsearch.index.datastream\\n| WHERE total_query_portion > 0\\n| KEEP\\n    elasticsearch.index.datastream,\\n    total_query_portion\\n| SORT total_query_portion DESC\"},\"visualization\":{\"shape\":\"pie\",\"layers\":[{\"layerId\":\"d0281a3d-d9b0-4846-9d04-d51456009536\",\"primaryGroups\":[\"elasticsearch.index.datastream\"],\"metrics\":[\"total_query_portion\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"fe0f14e4-6ae2-4375-9c0a-aea03a240a82\",\"gridData\":{\"i\":\"fe0f14e4-6ae2-4375-9c0a-aea03a240a82\",\"y\":41,\"x\":12,\"w\":12,\"h\":15}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# ECU data tier and data stream overview\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"66104f5a-f8cb-4203-bb9f-539d2bd5d218\",\"gridData\":{\"i\":\"66104f5a-f8cb-4203-bb9f-539d2bd5d218\",\"y\":71,\"x\":0,\"w\":48,\"h\":3}}]","timeRestore":false,"title":"CF ES|QL","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-05-31T05:09:24.267Z","created_by":"u_2001809318_cloud","id":"ae3ecf41-dbcb-4f95-98a9-5cb42e1299c8","managed":false,"references":[{"id":"1238481e-f5f7-419d-a171-57760b64ece6","name":"tag-ref-1238481e-f5f7-419d-a171-57760b64ece6","type":"tag"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-05-31T07:34:00.705Z","updated_by":"u_2001809318_cloud","version":"WzE2NywxXQ=="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":2,"missingRefCount":0,"missingReferences":[]}