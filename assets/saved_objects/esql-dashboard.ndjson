{"attributes":{"color":"#9f5aa3","description":"","name":"chargeback"},"coreMigrationVersion":"8.8.0","created_at":"2025-05-31T05:09:24.267Z","created_by":"u_2001809318_cloud","id":"1238481e-f5f7-419d-a171-57760b64ece6","managed":false,"references":[],"type":"tag","typeMigrationVersion":"8.0.0","updated_at":"2025-05-31T05:09:24.267Z","updated_by":"u_2001809318_cloud","version":"WzI1NTgsMV0="}
{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"hidePanelTitles\":false}","panelsJSON":"[{\"type\":\"lens\",\"title\":\"ECU spend over the last 6 months\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| KEEP @timestamp, deployment_name.keyword, total_ecu, total_ecu_value\"},\"timeRange\":{\"from\":\"now-6M\",\"to\":\"now\"},\"attributes\":{\"title\":\"total_ecu & total_ecu_value over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"c2dbde04-0769-4485-b4fa-4cb05a1d975e\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| KEEP @timestamp, deployment_name.keyword, total_ecu, total_ecu_value\"},\"columns\":[{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"deployment_name.keyword\",\"fieldName\":\"deployment_name.keyword\",\"label\":\"Deployment name\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_ecu\",\"fieldName\":\"total_ecu\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| KEEP @timestamp, deployment_name.keyword, total_ecu, total_ecu_value\"},\"visualization\":{\"legend\":{\"isVisible\":true,\"position\":\"right\"},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"c2dbde04-0769-4485-b4fa-4cb05a1d975e\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"deployment_name.keyword\",\"accessors\":[\"total_ecu\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"12f49116-e985-4996-823b-dd32865ae0fb\",\"gridData\":{\"i\":\"12f49116-e985-4996-823b-dd32865ae0fb\",\"y\":0,\"x\":0,\"w\":48,\"h\":8}},{\"type\":\"visualization\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"id\":\"\",\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# ECU deployment statistics\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"63625fd3-27d8-468f-bee9-a5d846460aa3\",\"gridData\":{\"i\":\"63625fd3-27d8-468f-bee9-a5d846460aa3\",\"y\":8,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# ECU data tier and data stream overview\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"a615f9c5-70b2-4cc2-9b3e-a6e6d49cd493\",\"gridData\":{\"i\":\"a615f9c5-70b2-4cc2-9b3e-a6e6d49cd493\",\"y\":26,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Indexing\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"cabad7dd-82b8-4e50-a139-822cb3c4bd27\",\"gridData\":{\"i\":\"cabad7dd-82b8-4e50-a139-822cb3c4bd27\",\"y\":39,\"x\":0,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Querying\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"b4049337-42a9-4fdb-9369-6ccf27e64905\",\"gridData\":{\"i\":\"b4049337-42a9-4fdb-9369-6ccf27e64905\",\"y\":39,\"x\":12,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Storage\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"d2826832-b0af-4a22-b488-149e6b7dd02b\",\"gridData\":{\"i\":\"d2826832-b0af-4a22-b488-149e6b7dd02b\",\"y\":39,\"x\":24,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Blended\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"1aed858d-aff5-49da-ae13-4c9c4fff8fc7\",\"gridData\":{\"i\":\"1aed858d-aff5-49da-ae13-4c9c4fff8fc7\",\"y\":39,\"x\":36,\"w\":12,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# ECU data tier and data stream per day\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"66104f5a-f8cb-4203-bb9f-539d2bd5d218\",\"gridData\":{\"i\":\"66104f5a-f8cb-4203-bb9f-539d2bd5d218\",\"y\":81,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"lens\",\"title\":\"Querying: ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_querying > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_querying DESC\"},\"attributes\":{\"title\":\"agg_querying over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"1a2f8269-f56f-4c02-8506-76b723acc828\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_querying > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_querying DESC\"},\"columns\":[{\"columnId\":\"agg_querying\",\"fieldName\":\"agg_querying\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_querying > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_querying DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"1a2f8269-f56f-4c02-8506-76b723acc828\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"datastream.keyword\",\"accessors\":[\"agg_querying\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"5561c496-d331-40c6-9880-0a01c5e46a2e\",\"gridData\":{\"i\":\"5561c496-d331-40c6-9880-0a01c5e46a2e\",\"y\":104,\"x\":0,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Indexing: ECU per tier per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_indexing > 0\"},\"attributes\":{\"title\":\"agg_indexing over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"d24af063-ec41-4736-bf4e-70f1fe4da4cf\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_indexing > 0\"},\"columns\":[{\"columnId\":\"agg_indexing\",\"fieldName\":\"agg_indexing\",\"label\":\"Indexing\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"tier\",\"fieldName\":\"tier\",\"label\":\"Data tier\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_indexing > 0\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"d24af063-ec41-4736-bf4e-70f1fe4da4cf\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"tier\",\"accessors\":[\"agg_indexing\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"b73d3a21-d805-4a12-80b1-7c75d1bd794a\",\"gridData\":{\"i\":\"b73d3a21-d805-4a12-80b1-7c75d1bd794a\",\"y\":87,\"x\":16,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Indexing: % ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp)\\n| WHERE elasticsearch.index.total.indexing.index_time_in_millis > 0\\n| STATS \\n //   sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis)\\n//    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n//    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.datastream\\n| STATS \\n    total_indexing_portion = sum(sum_indexing_time_local) \\n  BY \\n    @timestamp, \\n    elasticsearch.index.datastream \\n| KEEP \\n    @timestamp,\\n    elasticsearch.index.datastream,\\n    total_indexing_portion\\n| SORT total_indexing_portion DESC\\n\"},\"attributes\":{\"title\":\"total_indexing_portion over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"d5520b0e-567f-4f0a-b424-fc79eb79e2cc\":{\"index\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp)\\n| WHERE elasticsearch.index.total.indexing.index_time_in_millis > 0\\n| STATS \\n //   sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis)\\n//    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n//    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.datastream\\n| STATS \\n    total_indexing_portion = sum(sum_indexing_time_local) \\n  BY \\n    @timestamp, \\n    elasticsearch.index.datastream \\n| KEEP \\n    @timestamp,\\n    elasticsearch.index.datastream,\\n    total_indexing_portion\\n| SORT total_indexing_portion DESC\\n\"},\"columns\":[{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"elasticsearch.index.datastream\",\"fieldName\":\"elasticsearch.index.datastream\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"total_indexing_portion\",\"fieldName\":\"total_indexing_portion\",\"label\":\"Indexing\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"percent\",\"params\":{\"decimals\":0}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM monitoring-indices\\n| EVAL \\n    @timestamp = DATE_TRUNC(1 day, @timestamp)\\n| WHERE elasticsearch.index.total.indexing.index_time_in_millis > 0\\n| STATS \\n //   sum_query_time_local = sum(elasticsearch.index.total.search.query_time_in_millis), \\n    sum_indexing_time_local = sum(elasticsearch.index.total.indexing.index_time_in_millis)\\n//    sum_data_set_store_size_local = sum(elasticsearch.index.primaries.store.total_data_set_size_in_bytes),\\n//    sum_store_size_local = sum(elasticsearch.index.total.store.size_in_bytes)\\n  BY \\n    @timestamp,\\n    elasticsearch.cluster.name,\\n    elasticsearch.index.datastream\\n| STATS \\n    total_indexing_portion = sum(sum_indexing_time_local) \\n  BY \\n    @timestamp, \\n    elasticsearch.index.datastream \\n| KEEP \\n    @timestamp,\\n    elasticsearch.index.datastream,\\n    total_indexing_portion\\n| SORT total_indexing_portion DESC\\n\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"d5520b0e-567f-4f0a-b424-fc79eb79e2cc\",\"seriesType\":\"bar_percentage_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"elasticsearch.index.datastream\",\"accessors\":[\"total_indexing_portion\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\":{\"id\":\"3db0d6b31d8afd75067c7a445bb4f066a52d9d451e8237e51956bd0d7e1ecb52\",\"title\":\"monitoring-indices\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"monitoring-indices\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"ce5459c1-8c49-455b-bd12-b3b00ae6710f\",\"gridData\":{\"i\":\"ce5459c1-8c49-455b-bd12-b3b00ae6710f\",\"y\":87,\"x\":32,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Querying: ECU per tier per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_querying > 0\"},\"attributes\":{\"title\":\"agg_querying over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"61842c44-afd9-429c-bf2e-18a4a079e5e8\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_querying > 0\"},\"columns\":[{\"columnId\":\"agg_querying\",\"fieldName\":\"agg_querying\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"tier\",\"fieldName\":\"tier\",\"label\":\"tier\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_querying > 0\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"61842c44-afd9-429c-bf2e-18a4a079e5e8\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"tier\",\"accessors\":[\"agg_querying\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"acb3cbfb-cf2f-4e73-b9a1-dbd69fc023e8\",\"gridData\":{\"i\":\"acb3cbfb-cf2f-4e73-b9a1-dbd69fc023e8\",\"y\":104,\"x\":16,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"ECU per deployment and tier\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_blended = sum(blended) BY deployment_name.keyword, deployment_id , tier \\n| WHERE agg_blended > 0\"},\"attributes\":{\"title\":\"Table \",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"ba345378-8ee0-40ec-9fb0-d26588d09107\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_blended = sum(blended) BY deployment_name.keyword, deployment_id , tier \\n| WHERE agg_blended > 0\"},\"columns\":[{\"columnId\":\"c33c8ff5-8a22-4f4f-9b92-5e16485f5d9a\",\"fieldName\":\"deployment_name.keyword\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Deployment name\",\"customLabel\":true},{\"columnId\":\"b799493a-e75f-4ccc-844c-d5718215e9fb\",\"fieldName\":\"deployment_id\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Deployment ID\",\"customLabel\":true},{\"columnId\":\"2ab259ce-29c3-4c5c-817b-b7f036c62be8\",\"fieldName\":\"agg_blended\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"ECU\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"af3de6ff-d14d-4cea-bb56-4ee9012054b6\",\"fieldName\":\"tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Data tier\",\"customLabel\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_blended = sum(blended) BY deployment_name.keyword, deployment_id , tier \\n| WHERE agg_blended > 0\"},\"visualization\":{\"layerId\":\"ba345378-8ee0-40ec-9fb0-d26588d09107\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"c33c8ff5-8a22-4f4f-9b92-5e16485f5d9a\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"b799493a-e75f-4ccc-844c-d5718215e9fb\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"2ab259ce-29c3-4c5c-817b-b7f036c62be8\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"af3de6ff-d14d-4cea-bb56-4ee9012054b6\",\"isTransposed\":true,\"isMetric\":false}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\"}},\"panelIndex\":\"89aa67b9-2a47-41cd-b839-ed3518633409\",\"gridData\":{\"i\":\"89aa67b9-2a47-41cd-b839-ed3518633409\",\"y\":11,\"x\":0,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"ECU per deployment and tier\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_blended = sum(blended) BY deployment_name.keyword, deployment_id , tier \\n| WHERE agg_blended > 0\"},\"attributes\":{\"title\":\"Pie\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"91b4be84-6eb5-4b77-ad13-b85d992f3bbf\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_blended = sum(blended) BY deployment_name.keyword, deployment_id , tier \\n| WHERE agg_blended > 0\"},\"columns\":[{\"columnId\":\"agg_blended\",\"fieldName\":\"agg_blended\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"deployment_id\",\"fieldName\":\"deployment_id\",\"label\":\"Deployment ID\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}},{\"columnId\":\"ac7df1b7-c160-46d1-96b0-f3f44810dfd0\",\"fieldName\":\"tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Data tier\",\"customLabel\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_blended = sum(blended) BY deployment_name.keyword, deployment_id , tier \\n| WHERE agg_blended > 0\"},\"visualization\":{\"shape\":\"treemap\",\"layers\":[{\"layerId\":\"91b4be84-6eb5-4b77-ad13-b85d992f3bbf\",\"primaryGroups\":[\"deployment_id\",\"ac7df1b7-c160-46d1-96b0-f3f44810dfd0\"],\"metrics\":[\"agg_blended\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"0632b775-f08e-4c70-8fd2-92802579808c\",\"gridData\":{\"i\":\"0632b775-f08e-4c70-8fd2-92802579808c\",\"y\":11,\"x\":24,\"w\":24,\"h\":15}},{\"type\":\"lens\",\"title\":\"Blended: ECU totals by data stream\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0 and tier == \\\"hot/content\\\"\\n| SORT agg_blended DESC\"},\"attributes\":{\"title\":\"agg_indexing & agg_querying & agg_storage & agg_blended of datastream.keyword\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"a21abe71-d247-47eb-8c2f-81f2cf30b387\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0 and tier == \\\"hot/content\\\"\\n| SORT agg_blended DESC\"},\"columns\":[{\"columnId\":\"agg_indexing\",\"fieldName\":\"agg_blended\",\"label\":\"agg_indexing\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0 and tier == \\\"hot/content\\\"\\n| SORT agg_blended DESC\"},\"visualization\":{\"shape\":\"donut\",\"layers\":[{\"layerId\":\"a21abe71-d247-47eb-8c2f-81f2cf30b387\",\"primaryGroups\":[\"datastream.keyword\"],\"metrics\":[\"agg_indexing\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}},\"emptySizeRatio\":0.3}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"ea6ddb96-bf35-42a0-a43a-5af7f03fd080\",\"gridData\":{\"i\":\"ea6ddb96-bf35-42a0-a43a-5af7f03fd080\",\"y\":42,\"x\":36,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"Indexing: ECU totals by data stream\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_indexing > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_indexing DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"0f6d5278-b325-49bc-9eb7-2febd2a5de0f\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_indexing > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_indexing DESC\"},\"columns\":[{\"columnId\":\"agg_indexing\",\"fieldName\":\"agg_indexing\",\"label\":\"Indexing\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_indexing > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_indexing DESC\"},\"visualization\":{\"shape\":\"donut\",\"layers\":[{\"layerId\":\"0f6d5278-b325-49bc-9eb7-2febd2a5de0f\",\"primaryGroups\":[\"datastream.keyword\"],\"metrics\":[\"agg_indexing\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}},\"emptySizeRatio\":0.3}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"7498fb0f-a0af-48b9-81a6-f901e958fdaf\",\"gridData\":{\"i\":\"7498fb0f-a0af-48b9-81a6-f901e958fdaf\",\"y\":42,\"x\":0,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"Querying: ECU totals by data stream\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_querying > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_querying DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"3b03b6a8-35ae-4554-8bd6-a887d8b36748\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_querying > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_querying DESC\"},\"columns\":[{\"columnId\":\"agg_querying\",\"fieldName\":\"agg_querying\",\"label\":\"Querying\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n    agg_querying = sum(querying)\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_querying > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_querying DESC\"},\"visualization\":{\"shape\":\"donut\",\"layers\":[{\"layerId\":\"3b03b6a8-35ae-4554-8bd6-a887d8b36748\",\"primaryGroups\":[\"datastream.keyword\"],\"metrics\":[\"agg_querying\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}},\"emptySizeRatio\":0.3}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"0503ed3f-91b5-428b-a564-25c00b7e81ea\",\"gridData\":{\"i\":\"0503ed3f-91b5-428b-a564-25c00b7e81ea\",\"y\":42,\"x\":12,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"Storage: ECU totals by data stream\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"attributes\":{\"title\":\"Bar vertical stacked\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"2813628b-2a20-484c-9a19-11955d86e9ff\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"columns\":[{\"columnId\":\"agg_storage\",\"fieldName\":\"agg_storage\",\"label\":\"Storage\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n      datastream.keyword\\n      //deployment_name.keyword, deployment_id , \\n      //tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"visualization\":{\"shape\":\"donut\",\"layers\":[{\"layerId\":\"2813628b-2a20-484c-9a19-11955d86e9ff\",\"primaryGroups\":[\"datastream.keyword\"],\"metrics\":[\"agg_storage\"],\"numberDisplay\":\"percent\",\"categoryDisplay\":\"default\",\"legendDisplay\":\"default\",\"nestedLegend\":false,\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}},\"emptySizeRatio\":0.3}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsPie\"}},\"panelIndex\":\"2e925498-c643-40f8-88bc-b9bfd1491436\",\"gridData\":{\"i\":\"2e925498-c643-40f8-88bc-b9bfd1491436\",\"y\":42,\"x\":24,\"w\":12,\"h\":15}},{\"type\":\"lens\",\"title\":\"ECU per data stream per tier\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n//    deployment_name.keyword, deployment_id ,   \\n    datastream.keyword,\\n    tier \\n| WHERE agg_blended > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"attributes\":{\"title\":\"agg_indexing & agg_querying & agg_storage & agg_blended of datastream.keyword\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"d8b4b579-802a-433f-a022-1ccfcceacf23\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n//    deployment_name.keyword, deployment_id ,   \\n    datastream.keyword,\\n    tier \\n| WHERE agg_blended > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"columns\":[{\"columnId\":\"4a286643-5c55-46e7-bd13-3eca5f93b0ec\",\"fieldName\":\"datastream.keyword\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Data stream\",\"customLabel\":true},{\"columnId\":\"e1141bf4-673c-4ce5-83e0-e88218e11e45\",\"fieldName\":\"tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Data tier\",\"customLabel\":true},{\"columnId\":\"8f1212c0-2f7a-4b00-8e67-835b38013b2c\",\"fieldName\":\"agg_indexing\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Indexing\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"04d56171-d592-444e-a3dd-6ad849ad1f71\",\"fieldName\":\"agg_querying\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Querying\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"f232bbcc-87a2-48fa-b3a1-0a53ee00dd23\",\"fieldName\":\"agg_storage\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Storage\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"3f1dc3e1-2c1b-4837-8e22-a08aa0a8873e\",\"fieldName\":\"agg_blended\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Blended\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n//      @timestamp,\\n//    deployment_name.keyword, deployment_id ,   \\n    datastream.keyword,\\n    tier \\n| WHERE agg_blended > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"visualization\":{\"layerId\":\"d8b4b579-802a-433f-a022-1ccfcceacf23\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"4a286643-5c55-46e7-bd13-3eca5f93b0ec\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"e1141bf4-673c-4ce5-83e0-e88218e11e45\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"8f1212c0-2f7a-4b00-8e67-835b38013b2c\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"04d56171-d592-444e-a3dd-6ad849ad1f71\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"f232bbcc-87a2-48fa-b3a1-0a53ee00dd23\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"3f1dc3e1-2c1b-4837-8e22-a08aa0a8873e\",\"isTransposed\":false,\"isMetric\":true}],\"paging\":{\"size\":10,\"enabled\":true}},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\"}},\"panelIndex\":\"e652be15-057b-433f-a118-60440c95eda1\",\"gridData\":{\"i\":\"e652be15-057b-433f-a118-60440c95eda1\",\"y\":66,\"x\":0,\"w\":48,\"h\":15}},{\"type\":\"visualization\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"id\":\"\",\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"# Table below not correct\\nData stream, Data tier, and ECU on Indexing, Querying, Storage and Blended\\n???\\nSame value for each tier\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"23d871a4-aef2-44af-a559-fdea2f1dda95\",\"gridData\":{\"i\":\"23d871a4-aef2-44af-a559-fdea2f1dda95\",\"y\":57,\"x\":0,\"w\":48,\"h\":9}},{\"type\":\"lens\",\"title\":\"Blended value: ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = ((storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot\\n| STATS  \\n //   agg_indexing = sum(indexing),\\n //   agg_querying = sum(querying),\\n //   agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n //   tier \\n| WHERE agg_blended > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_blended DESC\"},\"attributes\":{\"title\":\"agg_blended over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"52906f25-a114-4d45-b425-f0ff154f4ac1\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = ((storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot\\n| STATS  \\n //   agg_indexing = sum(indexing),\\n //   agg_querying = sum(querying),\\n //   agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n //   tier \\n| WHERE agg_blended > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_blended DESC\"},\"columns\":[{\"columnId\":\"agg_blended\",\"fieldName\":\"agg_blended\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"datastream.keyword\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = ((storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot\\n| STATS  \\n //   agg_indexing = sum(indexing),\\n //   agg_querying = sum(querying),\\n //   agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n //   tier \\n| WHERE agg_blended > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_blended DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"52906f25-a114-4d45-b425-f0ff154f4ac1\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"datastream.keyword\",\"accessors\":[\"agg_blended\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"25690a43-07f8-4482-b7c1-26db3b91647c\",\"gridData\":{\"i\":\"25690a43-07f8-4482-b7c1-26db3b91647c\",\"y\":139,\"x\":0,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Storage: ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"attributes\":{\"title\":\"agg_storage over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"b72a0ab5-dbf5-4fd2-bdef-c855fe354bee\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"columns\":[{\"columnId\":\"agg_storage\",\"fieldName\":\"agg_storage\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"b72a0ab5-dbf5-4fd2-bdef-c855fe354bee\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"datastream.keyword\",\"accessors\":[\"agg_storage\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"023a6542-eef6-46d2-b2d4-efebac5f57b2\",\"gridData\":{\"i\":\"023a6542-eef6-46d2-b2d4-efebac5f57b2\",\"y\":121,\"x\":0,\"w\":16,\"h\":15}},{\"type\":\"lens\",\"title\":\"Querying: % ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n| STATS  \\n    agg_indexing = sum(indexing)\\n    BY \\n    @timestamp,  \\n    datastream.keyword\\n| WHERE agg_indexing > 0 \\n| SORT agg_indexing DESC\"},\"attributes\":{\"title\":\"agg_indexing over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"91bcc41e-3a2c-434d-8df7-29c01340e712\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n| STATS  \\n    agg_indexing = sum(indexing)\\n    BY \\n    @timestamp,  \\n    datastream.keyword\\n| WHERE agg_indexing > 0 \\n| SORT agg_indexing DESC\"},\"columns\":[{\"columnId\":\"agg_indexing\",\"fieldName\":\"agg_indexing\",\"label\":\"% ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"FROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n| STATS  \\n    agg_indexing = sum(indexing)\\n    BY \\n    @timestamp,  \\n    datastream.keyword\\n| WHERE agg_indexing > 0 \\n| SORT agg_indexing DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"91bcc41e-3a2c-434d-8df7-29c01340e712\",\"seriesType\":\"bar_percentage_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"datastream.keyword\",\"accessors\":[\"agg_indexing\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"2cb7ffd8-6577-4ea1-9998-e9b2c91b39c5\",\"gridData\":{\"i\":\"2cb7ffd8-6577-4ea1-9998-e9b2c91b39c5\",\"y\":104,\"x\":32,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Storage: % ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"attributes\":{\"title\":\"agg_storage over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"b72a0ab5-dbf5-4fd2-bdef-c855fe354bee\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"columns\":[{\"columnId\":\"agg_storage\",\"fieldName\":\"agg_storage\",\"label\":\"% ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n//    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_storage > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"b72a0ab5-dbf5-4fd2-bdef-c855fe354bee\",\"seriesType\":\"bar_percentage_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"datastream.keyword\",\"accessors\":[\"agg_storage\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"55f4c204-3334-446b-bab4-51ff8a520eea\",\"gridData\":{\"i\":\"55f4c204-3334-446b-bab4-51ff8a520eea\",\"y\":121,\"x\":32,\"w\":16,\"h\":15}},{\"type\":\"lens\",\"title\":\"Blended value: % ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword,\\n    tier \\n| WHERE agg_blended > 0 and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"attributes\":{\"title\":\"agg_indexing & agg_querying & agg_storage & agg_blended over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"8c2f087d-e623-4f6f-b232-97ab4284e4db\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword,\\n    tier \\n| WHERE agg_blended > 0 and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"columns\":[{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"},\"inMetricDimension\":true},{\"columnId\":\"30c47aa5-b389-479c-a2b6-d91c77a952b9\",\"fieldName\":\"agg_blended\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"% ECU\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"57d5389c-1311-460d-afe2-cecc4a8d16f4\",\"fieldName\":\"datastream.keyword\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Data stream\",\"customLabel\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword,\\n    tier \\n| WHERE agg_blended > 0 and tier == \\\"hot/content\\\"\\n| SORT agg_storage DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"8c2f087d-e623-4f6f-b232-97ab4284e4db\",\"seriesType\":\"bar_percentage_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"57d5389c-1311-460d-afe2-cecc4a8d16f4\",\"accessors\":[\"30c47aa5-b389-479c-a2b6-d91c77a952b9\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"05a9f5e5-ea38-47af-a66b-152b167c3bec\",\"gridData\":{\"i\":\"05a9f5e5-ea38-47af-a66b-152b167c3bec\",\"y\":139,\"x\":32,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Blended value: ECU per tier per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0\"},\"attributes\":{\"title\":\"agg_indexing & agg_querying & agg_storage & agg_blended over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"43f9cfe6-d828-4773-ab65-129f92cf7f4d\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0\"},\"columns\":[{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"},\"inMetricDimension\":true},{\"columnId\":\"50a91b89-2e68-4a69-90a0-d2ab79115b96\",\"fieldName\":\"tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Data tier\",\"customLabel\":true},{\"columnId\":\"1501af72-2509-4ae0-88a0-c1481e438377\",\"fieldName\":\"agg_blended\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"ECU\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"43f9cfe6-d828-4773-ab65-129f92cf7f4d\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"50a91b89-2e68-4a69-90a0-d2ab79115b96\",\"accessors\":[\"1501af72-2509-4ae0-88a0-c1481e438377\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"e56ef734-032b-4599-8ee7-416523ca35fe\",\"gridData\":{\"i\":\"e56ef734-032b-4599-8ee7-416523ca35fe\",\"y\":139,\"x\":16,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Indexing: ECU per data stream per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_indexing > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_indexing DESC\"},\"attributes\":{\"title\":\"agg_indexing over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"0ee24895-1496-4b23-96ec-ec09a8f49332\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_indexing > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_indexing DESC\"},\"columns\":[{\"columnId\":\"agg_indexing\",\"fieldName\":\"agg_indexing\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"datastream.keyword\",\"fieldName\":\"datastream.keyword\",\"label\":\"Data stream\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_datastream_contribution_lookup ON composite_key\\n//| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, datastream_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, datastream_sum_query_time / deployment_sum_query_time * total_ecu),\\n//    data_set = CASE (deployment_sum_data_set_store_size > 0, datastream_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n//    store = CASE (deployment_sum_store_size > 0, datastream_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n//    storage = CASE (store == 0 , data_set, store),\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n    agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying),\\n//    agg_storage = sum(storage),\\n//    agg_blended = sum(blended)\\n    BY \\n    @timestamp, \\n    //deployment_name.keyword, deployment_id ,   \\n    datastream.keyword\\n//    tier \\n| WHERE agg_indexing > 0 //and tier == \\\"hot/content\\\"\\n| SORT agg_indexing DESC\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"0ee24895-1496-4b23-96ec-ec09a8f49332\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"datastream.keyword\",\"accessors\":[\"agg_indexing\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"a950c1e8-6ceb-4240-8d98-0d1d1fe2aae5\",\"gridData\":{\"i\":\"a950c1e8-6ceb-4240-8d98-0d1d1fe2aae5\",\"y\":87,\"x\":0,\"w\":16,\"h\":14}},{\"type\":\"lens\",\"title\":\"Storage: ECU per tier per day\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n //   agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_storage > 0\"},\"attributes\":{\"title\":\"agg_storage over @timestamp\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"93fd5f12-463f-4e8e-a9b8-0ac77d0522a9\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n //   agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_storage > 0\"},\"columns\":[{\"columnId\":\"agg_storage\",\"fieldName\":\"agg_storage\",\"label\":\"ECU\",\"customLabel\":true,\"meta\":{\"type\":\"number\",\"esType\":\"double\"},\"inMetricDimension\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"@timestamp\",\"fieldName\":\"@timestamp\",\"label\":\"Date\",\"customLabel\":true,\"meta\":{\"type\":\"date\",\"esType\":\"date\"}},{\"columnId\":\"tier\",\"fieldName\":\"tier\",\"label\":\"Data tier\",\"customLabel\":true,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n//    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu)\\n//    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu)\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store)\\n//    storage_weight = 40,\\n//    query_weight = 20,\\n//    index_weight = 20,\\n//    total_weight_hot = storage_weight + query_weight + index_weight,\\n//    total_weight_cold = storage_weight + query_weight,\\n//    blended = CASE (\\n//        tier == \\\"hot/content\\\",\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight) +\\n//            (indexing * index_weight)\\n//        ) / total_weight_hot,\\n//        (\\n//            (storage * storage_weight) +\\n//            (querying * query_weight)\\n//        ) / total_weight_cold\\n//    )\\n| STATS  \\n //   agg_indexing = sum(indexing)\\n//    agg_querying = sum(querying)\\n    agg_storage = sum(storage)\\n//    agg_blended = sum(blended)\\n    BY \\n      @timestamp ,\\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_storage > 0\"},\"visualization\":{\"legend\":{\"isVisible\":false,\"position\":\"right\",\"showSingleSeries\":false},\"valueLabels\":\"hide\",\"fittingFunction\":\"Linear\",\"axisTitlesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"tickLabelsVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"labelsOrientation\":{\"x\":0,\"yLeft\":0,\"yRight\":0},\"gridlinesVisibilitySettings\":{\"x\":true,\"yLeft\":true,\"yRight\":true},\"preferredSeriesType\":\"bar_stacked\",\"layers\":[{\"layerId\":\"93fd5f12-463f-4e8e-a9b8-0ac77d0522a9\",\"seriesType\":\"bar_stacked\",\"xAccessor\":\"@timestamp\",\"splitAccessor\":\"tier\",\"accessors\":[\"agg_storage\"],\"layerType\":\"data\",\"colorMapping\":{\"assignments\":[],\"specialAssignments\":[{\"rule\":{\"type\":\"other\"},\"color\":{\"type\":\"loop\"},\"touched\":false}],\"paletteId\":\"default\",\"colorMode\":{\"type\":\"categorical\"}}}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsXY\"}},\"panelIndex\":\"83433c7f-831e-4263-a85e-e37c705ba82e\",\"gridData\":{\"i\":\"83433c7f-831e-4263-a85e-e37c705ba82e\",\"y\":121,\"x\":16,\"w\":16,\"h\":15}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Indexing details\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"87353edb-77f8-40bf-8e24-abc3fa768591\",\"gridData\":{\"i\":\"87353edb-77f8-40bf-8e24-abc3fa768591\",\"y\":84,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Querying details\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"0a9266ab-8708-44f2-9378-76ae3bab64f1\",\"gridData\":{\"i\":\"0a9266ab-8708-44f2-9378-76ae3bab64f1\",\"y\":101,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Storage details\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"fb2db01a-020f-4475-a4b6-f36743345859\",\"gridData\":{\"i\":\"fb2db01a-020f-4475-a4b6-f36743345859\",\"y\":118,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"visualization\",\"title\":\"\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"savedVis\":{\"title\":\"\",\"description\":\"\",\"type\":\"markdown\",\"params\":{\"fontSize\":12,\"openLinksInNewTab\":false,\"markdown\":\"## Blended details\"},\"uiState\":{},\"data\":{\"aggs\":[],\"searchSource\":{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}}}},\"panelIndex\":\"48caf4b4-8653-4653-9250-16606a15d7c7\",\"gridData\":{\"i\":\"48caf4b4-8653-4653-9250-16606a15d7c7\",\"y\":136,\"x\":0,\"w\":48,\"h\":3}},{\"type\":\"lens\",\"title\":\"ECU per tier\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"description\":\"ECU breakdown per tier, based on Indexing, Querying, Storage and a blended ratio of all of these.\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"searchSessionId\":\"07ea605f-6ccf-4062-9e19-89eef1c8c9f4\",\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0\"},\"attributes\":{\"title\":\"agg_indexing & agg_querying & agg_storage & agg_blended of tier\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"9d199172-f9fa-4fc4-82af-c7e2672a3f54\":{\"index\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0\"},\"columns\":[{\"columnId\":\"a76076ce-f372-4a48-857d-75010bbf5970\",\"fieldName\":\"tier\",\"meta\":{\"type\":\"string\",\"esType\":\"keyword\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"tier\"},{\"columnId\":\"6e881cac-4719-493c-95f8-e3bfa38c3219\",\"fieldName\":\"agg_indexing\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Indexing\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"97a86307-08fc-4b2d-a82a-36a2ecc9c75d\",\"fieldName\":\"agg_querying\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Querying\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"2b086331-8a38-4df2-b042-7827d3519d63\",\"fieldName\":\"agg_storage\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Storage\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}},{\"columnId\":\"307273f7-1b4c-450c-80cd-ef0326b38f6e\",\"fieldName\":\"agg_blended\",\"meta\":{\"type\":\"number\",\"esType\":\"double\",\"sourceParams\":{\"indexPattern\":\"billing_cluster_cost_lookup\"}},\"label\":\"Blended\",\"customLabel\":true,\"params\":{\"format\":{\"id\":\"number\",\"params\":{\"decimals\":2}}}}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeField\":\"@timestamp\"}]}},\"filters\":[],\"query\":{\"esql\":\"// ECU detail by tier\\nFROM billing_cluster_cost_lookup \\n| LOOKUP JOIN cluster_deployment_contribution_lookup ON composite_key\\n| LOOKUP JOIN cluster_tier_contribution_lookup ON composite_key\\n| EVAL \\n    indexing = CASE (deployment_sum_indexing_time > 0, tier_sum_indexing_time / deployment_sum_indexing_time * total_ecu),\\n    querying = CASE (deployment_sum_query_time > 0, tier_sum_query_time / deployment_sum_query_time * total_ecu),\\n    data_set = CASE (deployment_sum_data_set_store_size > 0, tier_sum_data_set_store_size / deployment_sum_data_set_store_size * total_ecu), // total data set storage\\n    store = CASE (deployment_sum_store_size > 0, tier_sum_store_size / deployment_sum_store_size * total_ecu), // only primary indices\\n    storage = CASE (store == 0 , data_set, store),\\n    storage_weight = 40,\\n    query_weight = 20,\\n    index_weight = 20,\\n    total_weight_hot = storage_weight + query_weight + index_weight,\\n    total_weight_cold = storage_weight + query_weight,\\n    blended = CASE (\\n        tier == \\\"hot/content\\\",\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight) +\\n            (indexing * index_weight)\\n        ) / total_weight_hot,\\n        (\\n            (storage * storage_weight) +\\n            (querying * query_weight)\\n        ) / total_weight_cold\\n    )\\n| STATS  \\n    agg_indexing = sum(indexing),\\n    agg_querying = sum(querying),\\n    agg_storage = sum(storage),\\n      agg_blended = sum(blended)\\n    BY \\n      //deployment_name.keyword, deployment_id , \\n      tier \\n| WHERE agg_blended > 0\"},\"visualization\":{\"layerId\":\"9d199172-f9fa-4fc4-82af-c7e2672a3f54\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"a76076ce-f372-4a48-857d-75010bbf5970\",\"isTransposed\":false,\"isMetric\":false},{\"columnId\":\"6e881cac-4719-493c-95f8-e3bfa38c3219\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"97a86307-08fc-4b2d-a82a-36a2ecc9c75d\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"2b086331-8a38-4df2-b042-7827d3519d63\",\"isTransposed\":false,\"isMetric\":true},{\"columnId\":\"307273f7-1b4c-450c-80cd-ef0326b38f6e\",\"isTransposed\":false,\"isMetric\":true}]},\"adHocDataViews\":{\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\":{\"id\":\"2bf6c0d816ef0a2d56d03ede549c16c08c35db2cf02d78c12756a98a33f50e4f\",\"title\":\"billing_cluster_cost_lookup\",\"timeFieldName\":\"@timestamp\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"billing_cluster_cost_lookup\",\"allowHidden\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\"}},\"panelIndex\":\"7e4213e1-0bb4-48fb-8e3f-99ab9dcdcc04\",\"gridData\":{\"i\":\"7e4213e1-0bb4-48fb-8e3f-99ab9dcdcc04\",\"y\":29,\"x\":0,\"w\":48,\"h\":10}}]","timeRestore":false,"title":"CF ES|QL","version":3},"coreMigrationVersion":"8.8.0","created_at":"2025-05-31T05:09:24.267Z","created_by":"u_2001809318_cloud","id":"ae3ecf41-dbcb-4f95-98a9-5cb42e1299c8","managed":false,"references":[{"id":"1238481e-f5f7-419d-a171-57760b64ece6","name":"tag-ref-1238481e-f5f7-419d-a171-57760b64ece6","type":"tag"}],"type":"dashboard","typeMigrationVersion":"10.2.0","updated_at":"2025-06-04T04:31:08.786Z","updated_by":"u_2001809318_cloud","version":"WzIwNiwxXQ=="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":2,"missingRefCount":0,"missingReferences":[]}